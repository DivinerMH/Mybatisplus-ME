�𰸵�ַ��https://www.cnblogs.com/holly8/p/7419012.html




�C1.ѧ����menghuan.com.ExcelStudentDTO(S#,Sname,Sage,Ssex)

	�CS# ѧ�����,Sname ѧ������,Sage ��������,Ssex ѧ���Ա�


�C2.�γ̱� Course(C#,Cname,T#) 
  	
�CC# �C�γ̱��,Cname �γ�����,T# ��ʦ���

�C3.��ʦ�� Teacher(T#,Tname)
 
	�CT# ��ʦ���,Tname ��ʦ����

�C4.�ɼ��� SC(S#,C#,score)
 
	�CS# ѧ�����,C# �γ̱��,score ����

������������



��ѧ���� menghuan.com.ExcelStudentDTO
��
create table tb_students(
snum varchar(10)  primary key,
sname varchar(20) not null,
sage datetime not null,
ssex varchar(2)	not null
);
insert into tb_students values('01','����', '1990-01-01','��');
insert into tb_students values('02','Ǯ��', '1990-12-21','��');
insert into tb_students values('03','���', '1990-05-20','��');
insert into tb_students values('04','����', '1990-08-06','��');
insert into tb_students values('05','��÷', '1991-12-01','Ů');
insert into tb_students values('06','����', '1992-03-01','Ů');
insert into tb_students values('07','֣��', '1989-07-01','Ů');
insert into tb_students values('08','����', '1990-01-20','Ů')

;

����Ŀ�� Coursecreate�� 
create table tb_courses(
cnum varchar(10) primary key,
cname nvarchar(10) not null,
tid varchar(10),
constraint FK01 foreign key(tid) references tb_teachers(tnum)
);

insert into tb_courses values('01', '����' , '02');
insert into tb_courses values('02','��ѧ' , '01');
insert into tb_courses values('03','Ӣ��' ,'03')

;

����ʦ�� Teacher��
create table tb_teachers(
	tnum varchar(10) primary key,
	tname varchar(20) not null
);
insert into tb_teachers values('01','����');
insert into tb_teachers values('02','����');
insert into tb_teachers values('03','����');



������ SC��
create table tb_sc(
sid varchar(10),
cid varchar(10),
score decimal(18,1),
constraint FK02 foreign key(sid) references tb_students(snum),
constraint FK03 foreign key(cid) references tb_courses(cnum),
primary key(sid,cid)
);

insert into tb_sc values('01', '01' , 80);
insert into tb_sc values('01' , '02' , 90);
insert into tb_sc values('01' , '03' , 99);
insert into tb_sc values('02' , '01' , 70);
insert into tb_sc values('02' , '02' , 60);
insert into tb_sc values('02' , '03' , 80);
insert into tb_sc values('03' , '01' , 80);
insert into tb_sc values('03' , '02' , 80);
insert into tb_sc values('03' , '03', 80);
insert into tb_sc values('04' , '01' , 50);
insert into tb_sc values('04' , '02' , 30);
insert into tb_sc values('04' , '03' , 20);
insert into tb_sc values('05' , '01' , 76);
insert into tb_sc values('05' , '02' , 87);
insert into tb_sc values('06' , '01' , 31);
insert into tb_sc values('06' , '03' , 34);
insert into tb_sc values('07' , '02' , 89);
insert into tb_sc values('07' , '03' , 98)

;


1. ��ѯ�� 01 ���γ̱ȡ� 02 ���γ̳ɼ��ߵ�ѧ������Ϣ���γ̷���
 select s.*,sc.cid,sc.score from tb_students s,tb_sc sc where snum= sid and snum in(select a.sid from tb_sc a,tb_sc b where a.sid=b.sid and a.cid='01'and b.cid='02'and a.score>b.score)
;



1.1 ��ѯͬʱ���ڡ� 01 ���γ̺͡� 02 ���γ̵����

select * from tb_students where snum in (
select sid from tb_sc where cid='01') and snum in (
select sid from tb_sc where cid='02');

1.2 ��ѯ���ڡ� 01 ���γ̵����ܲ����ڡ� 02 ���γ̵����(������ʱ��ʾΪ null )

select * from (select sid ,score from tb_sc where cid='01') s1 left join(select sid,score from tb_sc where cid='02')s2 on s1.sid=s2.sid;

1.3 ��ѯ�����ڡ� 01 ���γ̵����ڡ� 02 ���γ̵����
 select * from tb_sc where sid not in (
select sid from tb_sc where cid='01') and cid='02';

2. ��ѯƽ���ɼ����ڵ��� 60 �ֵ�ͬѧ��ѧ����ź�ѧ��������ƽ���ɼ�
select snum,sname,avg(score) from tb_students,tb_sc where snum=sid group by snum having avg(score)>60;

3. ��ѯ�� SC ����ڳɼ���ѧ����Ϣ

select*from tb_students where snum in (
select sid from tb_sc where score >=0
);

4. ��ѯ����ͬѧ��ѧ����š�ѧ��������ѡ�����������пγ̵��ܳɼ�(û�ɼ�����ʾΪ null )
select snum,sname,count(cid),sum(score) from tb_students left join tb_sc on snum =sid group by snum;

4.1 ���гɼ���ѧ����Ϣ


select*from tb_students where snum in (
select sid from tb_sc where score >=0
);
select*from tb_students where exists(
select * from tb_sc where sid=snum
);

5. ��ѯ�������ʦ������ 
select count(tname) from tb_teachers where tname like'��%';

6. ��ѯѧ������������ʦ�ڿε�ͬѧ����Ϣ 
select * from tb_students where snum  not in(
select sid from tb_sc where cid in(select cnum from tb_courses where tid=(select tnum from tb_teachers where tname='����'))
);
select tb_students.* from tb_students,tb_sc,tb_courses,tb_teachers where tname='����' and tid=tnum and cnum =cid and sid=snum;
7. ��ѯû��ѧȫ���пγ̵�ͬѧ����Ϣ 
 
select *from tb_students where snum not in (
select sid from tb_sc group by sid having count(*)=3
);

8. ��ѯ������һ�ſ���ѧ��Ϊ�� 01 ����ͬѧ��ѧ��ͬ��ͬѧ����Ϣ 

select distinct  s.* from tb_students s,tb_sc where snum=sid and sid in(select cid from tb_sc where sid='01') ;

9. ��ѯ�͡� 01 ���ŵ�ͬѧѧϰ�Ŀγ���ȫ��ͬ������ͬѧ����Ϣ 

select * from tb_students where snum in(select sid from tb_sc where cid in(
select cid from tb_sc where sid ='01') and sid !='01'group by sid having count(*)=(
select count(*) from tb_sc where sid ='01')
);


10. ��ѯûѧ������������ʦ���ڵ���һ�ſγ̵�ѧ������
 select s.sname from tb_students s where snum  not in(
select sid from tb_sc where cid in(select cnum from tb_courses where tid=(select tnum from tb_teachers where tname='����'))
);
11. ��ѯ���ż������ϲ�����γ̵�ͬѧ��ѧ�ţ���������ƽ���ɼ�
select snum,sname,avg(score) from tb_students,tb_sc where snum in(
select sid from tb_sc where score<60 group by sid having count(*)>=2) and snum=sid group by snum;
 

12. ������ 01 ���γ̷���С�� 60���������������е�ѧ����Ϣ
select * from tb_students where snum in(select sid from tb_sc where 
cid='01' and score <60 order by score desc);

13. ��ƽ���ɼ��Ӹߵ�����ʾ����ѧ�������пγ̵ĳɼ��Լ�ƽ���ɼ�
select * from tb_sc left join (select sid,avg(score) a from tb_sc  group by sid ) t1 on tb_sc.sid=t1.sid order by a desc;

14. ��ѯ���Ƴɼ���߷֡���ͷֺ�ƽ���֣�    
	��������ʽ��ʾ���γ� ID���γ� name����߷֣���ͷ֣�ƽ���֣������ʣ��е��ʣ������ʣ�������
    
	����Ϊ>=60���е�Ϊ��70-80������Ϊ��80-90������Ϊ��>=90
    
 	Ҫ������γ̺ź�ѡ����������ѯ����������������У���������ͬ�����γ̺���������

select cid,cname,max(score) ��߷�,min(score) ��ͷ�,avg(score) ƽ����,count(*) ѡ������,sum(case when score>=60 then 1 else 0 end)/count(*) ������,sum(case when score>=70 and score<80 then 1 else 0 end)/count(*) �е���,sum(case when score>=80 and score<90 then 1 else 0 end)/count(*) ������,sum(case when score>=90  then 1 else 0 end)/count(*) ������ from tb_sc,tb_courses where cid=cnum group  by cid order by count(*) desc,cid;

15. �����Ƴɼ��������򣬲���ʾ������ Score �ظ�ʱ�������ο�ȱ

select cid,@curRank:=@curRank+1 rank,score from (select @curRank:=0) as t,tb_sc order by score desc;


15.1 �����Ƴɼ��������򣬲���ʾ������ Score �ظ�ʱ�ϲ�����





16.  ��ѯѧ�����ܳɼ����������������ܷ��ظ�ʱ�������ο�ȱ

16.1 ��ѯѧ�����ܳɼ����������������ܷ��ظ�ʱ���������ο�ȱ

17. ͳ�Ƹ��Ƴɼ����������������γ̱�ţ��γ����ƣ�[100-85]��[85-70]��[70-60]��[60-0] ����ռ�ٷֱ�

select cid,cname,sum(case when score>=85 then 1 else 0 end)as 100��85,sum(case when score>=70 and score<85 then 1 else 0 end)as 85��70,sum(case when score>=70 and score<85 then 1 else 0 end)/count(*)as ռ��,sum(case when score>=60 and score<70 then 1 else 0 end)as 70��60,sum(case when score>=0 and score<60 then 1 else 0 end)as 60��0 from tb_courses,tb_sc where cid=cnum group by cid;

18. ��ѯ���Ƴɼ�ǰ�����ļ�¼



19. ��ѯÿ�ſγ̱�ѡ�޵�ѧ����


 

20. ��ѯ��ֻѡ�����ſγ̵�ѧ��ѧ�ź����� 

21. ��ѯ������Ů������

22. ��ѯ�����к��С��硹�ֵ�ѧ����Ϣ

23. ��ѯͬ��ͬ��ѧ����������ͳ��ͬ������

24. ��ѯ 1990 �������ѧ������

25. ��ѯÿ�ſγ̵�ƽ���ɼ��������ƽ���ɼ��������У�ƽ���ɼ���ͬʱ�����γ̱����������

26. ��ѯƽ���ɼ����ڵ��� 85 ������ѧ����ѧ�š�������ƽ���ɼ� 

27. ��ѯ�γ�����Ϊ����ѧ�����ҷ������� 60 ��ѧ�������ͷ��� 

28. ��ѯ����ѧ���Ŀγ̼��������������ѧ��û�ɼ���ûѡ�ε������

29. ��ѯ�κ�һ�ſγ̳ɼ��� 70 �����ϵ��������γ����ƺͷ���

30. ��ѯ������Ŀγ�

31. ��ѯ�γ̱��Ϊ 01 �ҿγ̳ɼ��� 80 �����ϵ�ѧ����ѧ�ź�����

32. ��ÿ�ſγ̵�ѧ������ 

33. �ɼ����ظ�����ѯѡ�ޡ���������ʦ���ڿγ̵�ѧ���У��ɼ���ߵ�ѧ����Ϣ����ɼ�

34. �ɼ����ظ�������£���ѯѡ�ޡ���������ʦ���ڿγ̵�ѧ���У��ɼ���ߵ�ѧ����Ϣ����ɼ�

35. ��ѯ��ͬ�γ̳ɼ���ͬ��ѧ����ѧ����š��γ̱�š�ѧ���ɼ� 

36. ��ѯÿ�Ź��ɼ���õ�ǰ����

37. ͳ��ÿ�ſγ̵�ѧ��ѡ������������ 5 �˵Ŀγ̲�ͳ�ƣ���

38. ��������ѡ�����ſγ̵�ѧ��ѧ�� 

39. ��ѯѡ����ȫ���γ̵�ѧ����Ϣ

40. ��ѯ��ѧ�������䣬ֻ��������� 

41. ���ճ����������㣬��ǰ���� < �������µ������������һ

42. ��ѯ���ܹ����յ�ѧ��

43. ��ѯ���ܹ����յ�ѧ��

44. ��ѯ���¹����յ�ѧ��

45. ��ѯ���¹����յ�ѧ��


